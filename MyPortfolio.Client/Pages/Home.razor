@page "/"
@using MyPortfolio.Client.Services
@inject IJSRuntime JS
@inject LanguageService Lang
<link href="css/home.css" rel="stylesheet" />

<div class="container-fluid d-flex flex-column flex-md-row align-items-center justify-content-between py-5 home-hero" style="position: relative; overflow: hidden;">
    <canvas id="starCanvas" style="position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; z-index: 0; pointer-events: none;"></canvas>
    <canvas id="particleCanvas" style="position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; z-index: 1; pointer-events: none;"></canvas>

    <div class="text-section text-center text-md-start mb-4 mb-md-0" style="position: relative; z-index: 1;">
        <p class="welcome-text">@Lang.T("hero", "welcome")</p>
        <h1><span class="hello-text">@Lang.T("hero", "hello")</span> @Lang.T("hero", "greeting")</h1>
        <h1>@Lang.T("hero", "iam").</h1>
        <p class="subtitle">@Lang.T("hero", "role")</p>

        <div class="mt-4 d-flex justify-content-center justify-content-md-start gap-3">
            <a href="/about" class="btn btn-primary">@Lang.T("hero", "aboutBtn")</a>
            <a href="/files/your_cv.pdf" class="btn btn-outline-secondary" target="_blank" download>@Lang.T("hero", "cvBtn")</a>
        </div>
    </div>

    <div class="image-section text-center hero-image-wrapper" style="position: relative; z-index: 1;">
        <img src="/images/profile.png" alt="Dilmurod's Photo" class="hero-photo img-fluid" />
    </div>
</div>

@code {
    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            await JS.InvokeVoidAsync("initializeBackground");
        }
    }

    protected override void OnInitialized()
    {
        Lang.OnLanguageChanged += HandleLanguageChanged;
    }

    private void HandleLanguageChanged()
    {
        InvokeAsync(StateHasChanged); 
    }

    public void Dispose()
    {
        Lang.OnLanguageChanged -= HandleLanguageChanged; 
    }
}